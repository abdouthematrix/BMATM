<UserControl
    x:Class="BMATM.Views.LoginView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <!--  Modern color palette  -->
        <SolidColorBrush x:Key="PrimaryBrush" Color="#2563EB" />
        <SolidColorBrush x:Key="PrimaryHoverBrush" Color="#1D4ED8" />
        <SolidColorBrush x:Key="BackgroundBrush" Color="#F8FAFC" />
        <SolidColorBrush x:Key="CardBrush" Color="#FFFFFF" />
        <SolidColorBrush x:Key="TextBrush" Color="#1E293B" />
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#64748B" />
        <SolidColorBrush x:Key="BorderBrush" Color="#E2E8F0" />
        <SolidColorBrush x:Key="ErrorBrush" Color="#DC2626" />
        <SolidColorBrush x:Key="ShadowBrush" Color="#10000000" />

        <!--  Styles  -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Padding" Value="16,12" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontFamily" Value="Segoe UI" />
            <Setter Property="Background" Value="{StaticResource CardBrush}" />
            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8">
                            <ScrollViewer
                                x:Name="PART_ContentHost"
                                Margin="{TemplateBinding Padding}"
                                VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}" />
                                <Setter Property="BorderThickness" Value="2" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernPasswordBox" TargetType="PasswordBox">
            <Setter Property="Padding" Value="16,12" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontFamily" Value="Segoe UI" />
            <Setter Property="Background" Value="{StaticResource CardBrush}" />
            <Setter Property="Foreground" Value="{StaticResource TextBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="PasswordBox">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8">
                            <ScrollViewer
                                x:Name="PART_ContentHost"
                                Margin="{TemplateBinding Padding}"
                                VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}" />
                                <Setter Property="BorderThickness" Value="2" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Padding" Value="24,12" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontFamily" Value="Segoe UI" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter
                                Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource PrimaryHoverBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1E40AF" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#94A3B8" />
                                <Setter Property="Cursor" Value="Arrow" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid>
        <!--  Background Gradient  -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0" Color="#F1F5F9" />
                <GradientStop Offset="1" Color="#E2E8F0" />
            </LinearGradientBrush>
        </Grid.Background>

        <!--  Main Content  -->
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
            <!--  Login Card  -->
            <Border
                MinWidth="400"
                MaxWidth="450"
                Padding="48,40"
                Background="{StaticResource CardBrush}"
                CornerRadius="16">
                <Border.Effect>
                    <DropShadowEffect
                        BlurRadius="20"
                        Direction="270"
                        ShadowDepth="8"
                        Color="#20000000" />
                </Border.Effect>

                <StackPanel>
                    <!--  Header  -->
                    <StackPanel Margin="0,0,0,32" HorizontalAlignment="Center">
                        <!--  Logo/Icon  -->
                        <Ellipse
                            Width="64"
                            Height="64"
                            Margin="0,0,0,16"
                            Fill="{StaticResource PrimaryBrush}">
                            <Ellipse.OpacityMask>
                                <RadialGradientBrush>
                                    <GradientStop Offset="0" Color="White" />
                                    <GradientStop Offset="1" Color="Transparent" />
                                </RadialGradientBrush>
                            </Ellipse.OpacityMask>
                        </Ellipse>

                        <!--  Title  -->
                        <TextBlock
                            Margin="0,0,0,8"
                            HorizontalAlignment="Center"
                            FontSize="28"
                            FontWeight="Bold"
                            Foreground="{StaticResource TextBrush}"
                            Text="BMATM System" />

                        <!--  Subtitle  -->
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="14"
                            Foreground="{StaticResource TextSecondaryBrush}"
                            Text="Branch ATM Management" />
                    </StackPanel>

                    <!--  Login Form  -->
                    <StackPanel>
                        <!--  Username Field  -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock
                                Margin="0,0,0,6"
                                FontSize="13"
                                FontWeight="Medium"
                                Foreground="{StaticResource TextBrush}"
                                Text="Username" />
                            <TextBox
                                x:Name="UsernameTextBox"
                                Style="{StaticResource ModernTextBox}"
                                TabIndex="1"
                                Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter" Command="{Binding LoginCommand}" />
                                </TextBox.InputBindings>
                            </TextBox>
                        </StackPanel>

                        <!--  Password Field  -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock
                                Margin="0,0,0,6"
                                FontSize="13"
                                FontWeight="Medium"
                                Foreground="{StaticResource TextBrush}"
                                Text="Password" />
                            <PasswordBox
                                x:Name="PasswordBox"
                                Style="{StaticResource ModernPasswordBox}"
                                TabIndex="2">
                                <PasswordBox.InputBindings>
                                    <KeyBinding Key="Enter" Command="{Binding LoginCommand}" />
                                </PasswordBox.InputBindings>
                            </PasswordBox>
                        </StackPanel>

                        <!--  Error Message  -->
                        <Border
                            Margin="0,0,0,20"
                            Padding="12"
                            Background="#FEF2F2"
                            BorderBrush="#FECACA"
                            BorderThickness="1"
                            CornerRadius="6"
                            Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <Ellipse
                                    Width="16"
                                    Height="16"
                                    Margin="0,1,8,0"
                                    VerticalAlignment="Top"
                                    Fill="{StaticResource ErrorBrush}" />
                                <TextBlock
                                    FontSize="13"
                                    Foreground="{StaticResource ErrorBrush}"
                                    Text="{Binding ErrorMessage}"
                                    TextWrapping="Wrap" />
                            </StackPanel>
                        </Border>

                        <!--  Login Button  -->
                        <Button
                            Height="48"
                            Margin="0,0,0,16"
                            Command="{Binding LoginCommand}"
                            IsEnabled="{Binding IsLoginEnabled}"
                            Style="{StaticResource ModernButton}"
                            TabIndex="3">
                            <StackPanel Orientation="Horizontal">
                                <!--  Loading Spinner  -->
                                <Grid Margin="0,0,8,0" Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Ellipse
                                        Width="16"
                                        Height="16"
                                        Stroke="White"
                                        StrokeDashArray="12,4"
                                        StrokeThickness="2">
                                        <Ellipse.RenderTransform>
                                            <RotateTransform />
                                        </Ellipse.RenderTransform>
                                        <Ellipse.Triggers>
                                            <EventTrigger RoutedEvent="Loaded">
                                                <BeginStoryboard>
                                                    <Storyboard RepeatBehavior="Forever">
                                                        <DoubleAnimation
                                                            Storyboard.TargetProperty="RenderTransform.Angle"
                                                            From="0"
                                                            To="360"
                                                            Duration="0:0:1" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </Ellipse.Triggers>
                                    </Ellipse>
                                </Grid>

                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Sign In" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsLoading}" Value="True">
                                                    <Setter Property="Text" Value="Signing In..." />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </Button>

                        <!--  Exit Button  -->
                        <Button
                            Height="40"
                            Background="Transparent"
                            Command="{Binding ExitCommand}"
                            Content="Exit Application"
                            Foreground="{StaticResource TextSecondaryBrush}"
                            Style="{StaticResource ModernButton}"
                            TabIndex="4">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{StaticResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="6">
                                        <ContentPresenter
                                            Margin="{TemplateBinding Padding}"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center" />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#F1F5F9" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>

                    <!--  Footer  -->
                    <StackPanel Margin="0,24,0,0" HorizontalAlignment="Center">
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="12"
                            Foreground="{StaticResource TextSecondaryBrush}"
                            Text="Banque Misr ATM Management System" />
                        <TextBlock
                            Margin="0,4,0,0"
                            HorizontalAlignment="Center"
                            FontSize="11"
                            Foreground="{StaticResource TextSecondaryBrush}"
                            Text="© 2024 Banque Misr. All rights reserved." />
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>